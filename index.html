<div id="progress-editor" style="display:flex;flex-direction:column;align-items:center;gap:14px;min-width:150px;max-width:96vw;margin-top:32px;">
  <div id="progress-preview" style="display:flex;gap:6px;"></div>
  
  <div style="display:flex;flex-direction:column;gap:6px;width:200px;">
    <label>Количество колб:<input type="number" id="pb-total" value="5" min="1" max="20"></label>
    <label>Заполнено колб:<input type="number" id="pb-filled" value="2" min="0" max="20"></label>
    <label>Размер колб (px):<input type="number" id="pb-size" value="60" min="20" max="200"></label>
    <label>Цвет свечения:<input type="color" id="pb-color" value="#00ff7b"></label>
    <label>Свечение:
      <select id="pb-glow">
        <option value="yes">Включено</option>
        <option value="no">Выключено</option>
      </select>
    </label>
    <button id="pb-copy" style="margin-top:10px;">Получить код</button>
    <textarea id="pb-code" readonly style="height:100px;background:#111;color:#0f0;font-family:monospace;"></textarea>
  </div>
</div>

<script>
const fullImg = "https://i.postimg.cc/7hBpJVf9/11-(1).png";
const emptyImg = "https://i.postimg.cc/xCQrw8wR/17.png";

function renderProgress() {
  const total = parseInt(document.getElementById("pb-total").value);
  let filled = parseInt(document.getElementById("pb-filled").value);
  const size = parseInt(document.getElementById("pb-size").value);
  const color = document.getElementById("pb-color").value;
  const glow = document.getElementById("pb-glow").value === "yes";

  if(filled>total) filled=total;
  if(filled<0) filled=0;

  const preview = document.getElementById("progress-preview");
  let html = "";

  for(let i=0;i<total;i++){
    if(i<filled){
      html += `<img src="${fullImg}" width="${size}" style="margin-right:6px;${glow?'filter:drop-shadow(0 0 15px '+color+');':''}">`;
    } else {
      html += `<img src="${emptyImg}" width="${size}" style="margin-right:6px;">`;
    }
  }

  html += `<span style="font-size:20px;font-weight:bold;color:${color};text-shadow:0 0 10px ${color};margin-left:10px;vertical-align:middle;">${filled} / ${total}</span>`;
  preview.innerHTML = html;
  document.getElementById("pb-code").value = html;
}

// события
document.getElementById("pb-total").oninput = renderProgress;
document.getElementById("pb-filled").oninput = renderProgress;
document.getElementById("pb-size").oninput = renderProgress;
document.getElementById("pb-color").oninput = renderProgress;
document.getElementById("pb-glow").onchange = renderProgress;
document.getElementById("pb-copy").onclick = ()=>{
  const ta = document.getElementById("pb-code");
  ta.select();
  document.execCommand("copy");
  alert("Код скопирован! Вставляйте в Genially.");
}

renderProgress();
</script>
